name: Daily Rebalance (headless)

on:
  workflow_dispatch: {}
  schedule:
    - cron: "25 17 * * 1-5"   # 1:25 PM US/Eastern during daylight time (UTC-4)

jobs:
  run:
    runs-on: ubuntu-latest
    timeout-minutes: 20
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"
      - run: pip install -r requirements.txt
      - name: Run headless rebalance
        run: python runner.py
        env:
          # ---- strategy & safety (edit as you like) ----
          LIVE_TRADING: "false"            # keep false until you're ready
          UNIVERSE_SRC: "S&P 500 (auto)"
          RAW_TICKERS: "AAPL,MSFT,GOOG"
          INCLUDE_CRYPTO: "true"
          ALLOC_MODE: "Fixed $ per trade"
          FIXED_PER_TRADE: "5"
          PROP_TOTAL_BUDGET: "15"
          MIN_PER_ORDER: "2"
          N_PICKS: "3"
          USE_CRYPTO_LIMITS: "true"
          CRYPTO_LIMIT_BPS: "20"
          USE_STOCK_LIMITS: "false"
          STOCK_LIMIT_BPS: "25"
          AUTO_BP: "false"
          BP_PCT: "30"
          MAX_BUY_ORDERS: "12"
          MAX_BUY_NOTIONAL: "50"
          # ---- creds (GH Actions secrets) ----
          ROBINHOOD_USERNAME: ${{ secrets.ROBINHOOD_USERNAME }}
          ROBINHOOD_PASSWORD: ${{ secrets.ROBINHOOD_PASSWORD }}
          RH_USERNAME:        ${{ secrets.RH_USERNAME }}
          RH_PASSWORD:        ${{ secrets.RH_PASSWORD }}
          RH_TOTP_SECRET:     ${{ secrets.RH_TOTP_SECRET }}
